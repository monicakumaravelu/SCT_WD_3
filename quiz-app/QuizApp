import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.util.*;

class Question {
    String question;
    String[] options;
    int correctIndex;

    Question(String q, String[] o, int correct) {
        question = q;
        options = o;
        correctIndex = correct;
    }
}

public class QuizApp extends JFrame implements ActionListener {
    ArrayList<Question> questions;
    int current = 0, score = 0;
    JLabel questionLabel, timerLabel;
    JRadioButton[] options;
    ButtonGroup group;
    JButton nextButton, submitButton, retakeButton;
    Timer timer;
    int timeLeft = 20;
    String userName;

    QuizApp(String name) {
        userName = name;
        setupUI();
        loadQuestions();
        startQuiz();
    }

    void setupUI() {
        setTitle("Java Quiz Application");
        setSize(550, 350);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLayout(new BorderLayout(10, 10));

        // Header (question + timer)
        JPanel topPanel = new JPanel(new BorderLayout());
        questionLabel = new JLabel();
        questionLabel.setFont(new Font("Arial", Font.BOLD, 16));
        timerLabel = new JLabel("Time left: 20s");
        timerLabel.setFont(new Font("Arial", Font.PLAIN, 14));
        timerLabel.setForeground(Color.RED);
        topPanel.add(questionLabel, BorderLayout.WEST);
        topPanel.add(timerLabel, BorderLayout.EAST);
        add(topPanel, BorderLayout.NORTH);

        // Options
        JPanel optionsPanel = new JPanel(new GridLayout(4, 1));
        options = new JRadioButton[4];
        group = new ButtonGroup();
        for (int i = 0; i < 4; i++) {
            options[i] = new JRadioButton();
            group.add(options[i]);
            optionsPanel.add(options[i]);
        }
        add(optionsPanel, BorderLayout.CENTER);

        // Buttons
        JPanel buttonPanel = new JPanel();
        nextButton = new JButton("Next");
        submitButton = new JButton("Submit");
        nextButton.addActionListener(this);
        submitButton.addActionListener(this);
        buttonPanel.add(nextButton);
        buttonPanel.add(submitButton);
        add(buttonPanel, BorderLayout.SOUTH);

        // Timer
        timer = new Timer(1000, e -> {
            timeLeft--;
            timerLabel.setText("Time left: " + timeLeft + "s");
            if (timeLeft == 0) nextQuestion();
        });

        setVisible(true);
    }

    void loadQuestions() {
        questions = new ArrayList<>(Arrays.asList(
            new Question("What is JVM in Java?",
                    new String[]{"Java Virtual Machine", "Java Visual Model", "Java Variable Method", "Java Version Manager"}, 0),
            new Question("Who invented Java?",
                    new String[]{"James Gosling", "Dennis Ritchie", "Guido van Rossum", "Tim Berners-Lee"}, 0),
            new Question("Which company currently owns Java?",
                    new String[]{"Microsoft", "Google", "Oracle", "IBM"}, 2),
            new Question("Which keyword is used to inherit a class in Java?",
                    new String[]{"extends", "implements", "inherits", "instanceof"}, 0),
          
        ));

        // Shuffle questions each time
        Collections.shuffle(questions);
    }

    void startQuiz() {
        current = 0;
        score = 0;
        timeLeft = 20;
        loadQuestion();
        timer.start();
    }

    void loadQuestion() {
        if (current < questions.size()) {
            Question q = questions.get(current);
            questionLabel.setText(q.question);
            for (int i = 0; i < 4; i++) {
                options[i].setText(q.options[i]);
            }
            group.clearSelection();
            timeLeft = 20;
            timerLabel.setText("Time left: " + timeLeft + "s");
        }
    }

    boolean checkAnswer() {
        int selected = -1;
        for (int i = 0; i < 4; i++) {
            if (options[i].isSelected()) selected = i;
        }
        return selected == questions.get(current).correctIndex;
    }

    void nextQuestion() {
        if (checkAnswer()) score++;
        current++;
        if (current >= questions.size()) {
            timer.stop();
            showResults();
        } else {
            loadQuestion();
        }
    }

    void showResults() {
        getContentPane().removeAll();
        repaint();

        double percentage = ((double) score / questions.size()) * 100;
        String feedback;
        Color feedbackColor;

        if (percentage >= 80) { feedback = "Excellent! ðŸ’ª"; feedbackColor = new Color(0, 180, 0); }
        else if (percentage >= 50) { feedback = "Good Job! ðŸ™‚"; feedbackColor = new Color(255, 165, 0); }
        else { feedback = "Try Again! ðŸ˜…"; feedbackColor = Color.RED; }

        JPanel resultPanel = new JPanel(new GridLayout(6, 1, 5, 5));
        resultPanel.add(new JLabel("ðŸŽ¯ Quiz Completed!"));
        resultPanel.add(new JLabel("Name: " + userName));
        resultPanel.add(new JLabel("Score: " + score + "/" + questions.size()));
        resultPanel.add(new JLabel(String.format("Percentage: %.2f%%", percentage)));
        JLabel fbLabel = new JLabel("Feedback: " + feedback);
        fbLabel.setForeground(feedbackColor);
        resultPanel.add(fbLabel);

        // Retake button
        retakeButton = new JButton("Retake Quiz");
        retakeButton.addActionListener(e -> {
            getContentPane().removeAll();
            repaint();
            loadQuestions();
            startQuiz();
        });
        resultPanel.add(retakeButton);

        for (Component c : resultPanel.getComponents()) {
            if (c instanceof JLabel) {
                ((JLabel) c).setHorizontalAlignment(SwingConstants.CENTER);
                c.setFont(new Font("Arial", Font.PLAIN, 16));
            }
        }

        add(resultPanel, BorderLayout.CENTER);
        revalidate();
        repaint();
    }

    public void actionPerformed(ActionEvent e) {
        if (e.getSource() == nextButton) {
            nextQuestion();
        } else if (e.getSource() == submitButton) {
            timer.stop();
            nextQuestion();
        }
    }

    public static void main(String[] args) {
        String name = JOptionPane.showInputDialog("Enter your name:");
        if (name != null && !name.trim().isEmpty()) {
            new QuizApp(name);
        } else {
            JOptionPane.showMessageDialog(null, "Name is required to start the quiz!");
        }
    }
}
